<!--
C1 generated!!
Title = all keywords, max 65 chars
<title>File-system and filesharing in iOS</title>
Description = all keywords + extra text
<meta name="Description" content="File-system and filesharing in iOS : Locations, paths" />
Url = all keywords, whitespace and forbidden characters replaced with - lower case, max 65 chars
url: file-system-and-filesharing-in-ios
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
</head>
<body lang="en-us" xml:lang="en-us">
	<f:function name="HolisticWare.Optimizations.SearchEngine.MetaTagsKeywords" xmlns:f="http://www.composite.net/ns/function/1.0">
		<!--
		Keywords = 
		-->
		<f:param name="KeywordsAdditional" value="ios, monotouch, filesystem, system.environment.specialfolder enum, folders, filesharing, sharing" />
		<f:param name="AuthorsAdditional" value="mcvjetko" />
		<f:param name="Date" value="2012-11-13" />
		<f:param name="Language" value="en" />
	</f:function>


	<h1>Filesystem and filesharing in iOS</h1>

	<!--
	http://www.raywenderlich.com/1948/how-integrate-itunes-file-sharing-with-your-ios-app
	-->
	<!-- ================================================================== -->
	<h2>Filesystem in iOS</h2>
	<p>
	References:
	</p>
	<ul>
		<li>
			<a href="http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx">
				http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx
			</a>
		</li>
		<li>
			<a href="http://docs.xamarin.com/ios/tutorials/Working_with_the_File_System">
			http://docs.xamarin.com/ios/tutorials/Working_with_the_File_System
			</a>
			NOTE: these docs are changing really fast!
		</li>
	</ul>


	<!-- ================================================================== -->
	<!--
	<f:function name="HolisticWare.Content.TableOfContents" xmlns:f="http://www.composite.net/ns/function/1.0" />
	-->
	<h2>iOS application structure</h2>

	<ul>
		<li>
			Files needed by application (textual, xml database) can be deployed (pre-populated) thorugh Xcode or 
			MonoDevelop projects. Deployment actually means added to bundle (ipa or app archive).
			This archive is moved as folder to simulator or deployed as compressed archive (zipped) and extracted
			on the device.
			<br />
			(For MonoDevelop see:)
			<a href=""
				>
			</a>
			<br />
		</li>		
		<li>
			Files in the bundle are writeable, but only in 
			<ul>
				<li>
					app folder (BundleName.app) and 
				</li>
				<li>
					one folder above
				</li>
			</ul>
		</li>
		<li>
			Simulator behaves differently

		</li>
		<li>
			Folders recommended for writeable files are 
			<ul>
				<li>
					..\Documents
				</li>
				<li>
					..\tmp
				</li>
			</ul>

		</li>
		<li>
			Deleting application - removes all folders.
		</li>
		<li>
			Folders retained accros installs/updates:
			<ul>
				<li>
					..\Documents
				</li>
				<li>
					..\tmp
				</li>
			</ul>

		</li>
	</ul>

	<!--
	References:
	http://docs.xamarin.com/ios/Guides/Application_Fundamentals/Working_with_the_File_System

	http://monotouch.2284126.n4.nabble.com/a-couple-of-deployment-questions-with-app-store-approval-td4656718.html
	"will need to copy it out to the user folder before you can write to it - files in the bundle are not writable"
	Files are writeable, but app may be rejected!

	http://stackoverflow.com/questions/1829954/write-to-a-file-in-monotouch

	had may app rejected once for storing in the Personal folder content considered 
	by the Apple reviewer as not generated by the app
	-->
	<!-- ================================================================== -->
	<h2>Application deployment location</h2>


	<h3>Simulator</h3>

	<ol>
		<li>
			Location:
			<p>
				NOTE: Actual paths replaced with $HOME - standard unix home!
			</p>
			<pre class="hw_code">
			$HOME/Library/Application Support/iPhone Simulator/6.0/Applications/{APPGUID}

			Posix
				 $HOME/Library/Application Support/iPhone Simulator/5.0/Applications/{APPGUID}/Documents

			url
				file://$HOME/Library/Application%20Support/iPhone%20Simulator/5.0/Applications/{APPGUID}/Documents/

			windows (no winows HOME variable - %USERPROFILE%
				%HOME%/Library/Application Support/iPhone Simulator/5.0/Applications/{APPGUID}/Documents

			hfs
				OSX:Users:mc:Library:Application Support:iPhone Simulator:5.0:Applications:{APPGUID}:Documents

			terminal
				$HOME/Library/Application/ Support/iPhone/ Simulator/5.0/Applications/{APPGUID}/Documents
			</pre>
		</li>
		<li>
			Content (for some sample app) [MacOSX: find .]:
			<pre class="hw_code">
.
./Documents
./Documents/NewDirectory
./Documents/Write.txt
./Library
./Library/Caches
./Library/Caches/com.xamarin.samples.filesystem
./Library/Caches/com.xamarin.samples.filesystem/Cache.db
./Library/Caches/Snapshots
./Library/Preferences
./Library/Preferences/.GlobalPreferences.plist
./Library/Preferences/com.apple.PeoplePicker.plist
./tmp
./XsampleFilesystemAndSharingMT.app
./XsampleFilesystemAndSharingMT.app/FileSystem
./XsampleFilesystemAndSharingMT.app/FileSystem.exe
./XsampleFilesystemAndSharingMT.app/FileSystem.exe.mdb
./XsampleFilesystemAndSharingMT.app/Info.plist
./XsampleFilesystemAndSharingMT.app/Mono.Security.dll
./XsampleFilesystemAndSharingMT.app/Mono.Security.dll.mdb
./XsampleFilesystemAndSharingMT.app/monotouch.dll
./XsampleFilesystemAndSharingMT.app/monotouch.dll.mdb
./XsampleFilesystemAndSharingMT.app/MonoTouchDebugConfiguration.txt
./XsampleFilesystemAndSharingMT.app/MonoTouchSimulatorAssemblies.list
./XsampleFilesystemAndSharingMT.app/mscorlib.dll
./XsampleFilesystemAndSharingMT.app/mscorlib.dll.mdb
./XsampleFilesystemAndSharingMT.app/Settings.bundle
./XsampleFilesystemAndSharingMT.app/Settings.bundle/Root.plist
./XsampleFilesystemAndSharingMT.app/System.Core.dll
./XsampleFilesystemAndSharingMT.app/System.Core.dll.mdb
./XsampleFilesystemAndSharingMT.app/System.dll
./XsampleFilesystemAndSharingMT.app/System.dll.mdb
./XsampleFilesystemAndSharingMT.app/System.Xml.dll
./XsampleFilesystemAndSharingMT.app/System.Xml.dll.mdb
./XsampleFilesystemAndSharingMT.app/TestData
./XsampleFilesystemAndSharingMT.app/TestData/ReadMe.txt
./XsampleFilesystemAndSharingMT.app/TestData/Test.xml
			</pre>
		</li>
	</ol>


	<h3>Device</h3>
	<p>
		Tool for exploring file-system on iOS device: iFile.
		<br />
		iFile has Web server, so it is possible to explore contents of the file-system
		remotely over http (from Mac or PC)
	</p>
	<pre class="hw_code">
		http://$device_ip_address:10000/$path_absolute
	</pre>
	<p>
		Sample device (file-system) root:
	</p>
	<pre class="hw_code">	
/
	Applications/	
	Developer/
	Library/	
	System/
	User/
	Volumes/
	bin/
	boot/
	cores/
	dev/
	etc/
	lib/
	mnt/
	private/
	sbin/
	tmp/
	usr/
	var/
	</pre>

	<p>
		Application location for applications installed by user:
	</p>	
	<pre class="hw_code">	
		/User/Applications/{APPGUID}
	</pre>
	<p>
		linked to
	</p>
	<pre class="hw_code">	
	/var/mobile/Applications/{APPGUID}
	</pre>

	<p>
		Sample:
	</p>
	<pre class="hw_code">	
		http://$device_ip_address:10000/var/mobile/Applications/{APPGUID}/
	</pre>
	<pre class="hw_code">	
/var/mobile/Applications/{APPGUID}	
	Documents/
		NewDirectory/
		Write.txt	
	Library/
		Caches/	
			com.xamarin.samples.filesystem/	
				Cache.db
		Preferences/
			.GlobalPreferences.plist
			com.apple.PeoplePicker.plist
	tmp/	
	XsampleFilesystemAndSharingMT.app/	
		FileSystem
		FileSystem.exe
		FileSystem.exe.mdb
		Info.plist
		Mono.Security.dll
		Mono.Security.dll.mdb
		MonoTouchDebugConfiguration.txt
		PkgInfo
		ResourceRules.plist
		System.Core.dll
		System.Core.dll.mdb
		System.Xml.dll
		System.Xml.dll.mdb
		System.dll
		System.dll.mdb
		embedded.mobileprovision
		monotouch.dll
		monotouch.dll.mdb
		mscorlib.dll
		mscorlib.dll.mdb
		Settings.bundle/
			Root.plist
		TestData/
			ReadMe.txt
			Test.xml		
		_CodeSignature/	
			CodeResources
		</pre>


	<!-- ================================================================== -->
	<h2>MonoTouch SpecialFolder enumeration</h2>

	<pre class="hw_code">
mydocuments             = /private/var/mobile/Applications/{APPGUID}/Documents
personal                = /private/var/mobile/Applications/{APPGUID}/Documents
program_files           = /Applications
programs                =
common_program_files    =
common_application_data = /usr/share
application_data		=
cookies					= /private/var/mobile/Applications/{APPGUID}/Desktop
desktop					= /private/var/mobile/Applications/{APPGUID}/Desktop
desktop_directory		= /private/var/mobile/Applications/{APPGUID}/Library/Favorites
favorites				=
history					= /private/var/mobile/Applications/{APPGUID}/Library/Caches
internet_cache			= /private/var/mobile/Applications/{APPGUID}/Documents
loacal_application_data =
mymusic					= /private/var/mobile/Applications/{APPGUID}/Music
mypictures				= /private/var/mobile/Applications/{APPGUID}/Pictures
myvideos				= /private/var/mobile/Applications/{APPGUID}/Videos
recent					=
sendto					=
start_menu				=
startup					=
system					=
startup					=
templates				= /private/var/mobile/Applications/{APPGUID}/Templates
	</pre>


	

	<!-- ================================================================== -->
	<h2>Filesharing</h2>
	
	<p>
		References:
	</p>
	<ul>
		<li>
			<a href="http://docs.xamarin.com/ios/tutorials/Working_with_the_File_System">
			http://docs.xamarin.com/ios/tutorials/Working_with_the_File_System
			</a>
			NOTE: these docs are changing really fast!
		</li>
		<li>
			<a href="http://jamesantrobus.wordpress.com/2011/01/16/itunes-file-sharing-with-monotouch/">
				http://jamesantrobus.wordpress.com/2011/01/16/itunes-file-sharing-with-monotouch/
			</a>
		</li>
	</ul>
	<ol>
		<li>
			In property editor in xcode (plist editor) add key-value pair with key=UIFileSharingEnabled 
			and value=true:
			<img
				alt="iTunes filesharing"
				title="iTunes filesharing"
				src="/mm/holisticware/know-how/development/mobile/ios/monotouch/filesharing-itunes/screen-shot-2012-10-26.11.02.18-itunes-filesharing-plist.png"
				height="256" width="610"
			/>

		</li>
		<li>
			result differs after saving:
			<img
				alt="iTunes filesharing"
				title="iTunes filesharing"
				src="/mm/holisticware/know-how/development/mobile/ios/monotouch/filesharing-itunes/screen-shot-2012-10-26.11.02.39-itunes-filesharing-plist.png"
				height="256" width="610"
			/>
		</li>
	</ol>

	<p>
		The same can be obtained with editing plist.info file:
	</p>
	<pre class="hw_code">
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;
&lt;plist version=&quot;1.0&quot;&gt;
&lt;dict&gt;	
	 &lt;key&gt;UIFileSharingEnabled&lt;/key&gt;
	 &lt;true/&gt;
	 &lt;key&gt;CFBundleIdentifier&lt;/key&gt;
	 &lt;string&gt;&lt;/string&gt;
	 &lt;key&gt;UIDeviceFamily&lt;/key&gt;
	 &lt;array&gt;
		  &lt;integer&gt;2&lt;/integer&gt;
	 &lt;/array&gt;
	 &lt;key&gt;UISupportedInterfaceOrientations~ipad&lt;/key&gt;
	 &lt;array&gt;
		  &lt;string&gt;UIInterfaceOrientationPortrait&lt;/string&gt;
		  &lt;string&gt;UIInterfaceOrientationPortraitUpsideDown&lt;/string&gt;
		  &lt;string&gt;UIInterfaceOrientationLandscapeLeft&lt;/string&gt;
		  &lt;string&gt;UIInterfaceOrientationLandscapeRight&lt;/string&gt;
	 &lt;/array&gt;
	 &lt;key&gt;MinimumOSVersion&lt;/key&gt;
	 &lt;string&gt;3.2&lt;/string&gt;
	 &lt;key&gt;UIAppFonts&lt;/key&gt;
	 &lt;array&gt;
		  &lt;string&gt;Fonts/Tahoma.ttf&lt;/string&gt;
	 &lt;/array&gt;
&lt;/dict&gt;
&lt;/plist&gt;	</pre>





	<!-- ================================================================== -->
	<!--
	http://holisticware.net/HolisticWare/Know-How/development/Mobile/iOS1/file-system-and-filesharing-in-ios.aspx
	-->
</body>
</html>


<!--





Inside of that, there's a User/Applications folder that contains the apps you've installed
to the simulator. Drill down into any one of those folders, and you can see the folder 
structure your app will have access to on the phone.

For storing files that you'd like persisted across app sessions, your app's Documents 
folder is the spot. It's not your only choice for creating files, but it's the right 
choice for this job. In addition to your files being properly stored, keeping them in 
the Documents folder will also get them backed up by iTunes when the user syncs.

With MonoTouch, you can get your app's Documents folder path with 
"Environment.GetFolderPath(Environment.SpecialFolder.Personal);".

If you'd like to test it out, this is some extremely simple code that'll write a file 
called "out.txt" to your app's Documents folder. This code also reads the contents of 
the file to show it was created - for further verification, go to the simulator's 
Applications folder, sort the app folders by the date they were modified, drill down 
into the most recently modified, and look inside its Documents folder - you'll find 
"out.txt" (you can't find your app's folder by name because, when your app is 
installed, it gets stuffed inside a folder with a name like "2B3CA854-FADB-4DDC-9732-0E61B3DD8D8C" -
 sorting the folders by the date they were modified will point you to the most recently 
 modified app, which, in this case, is whatever app contains the following code):

// For this to function, don't forget "using System.IO;"

// If you're just playing around with this to see it work, place it inside
// your AppDelegate's "FinishedLaunching" method in main.cs

string path = Environment.GetFolderPath (Environment.SpecialFolder.Personal);
string filePath = Path.Combine(path, "out.txt");

// File.WriteAllText will create a file and then write text to it. If the
// file already exists, File.WriteAllText will overwrite it.
File.WriteAllText(filePath, "Howdy, world.");

// Now we prove it worked by reading the contents of the file and then
// printing them to the console...   
string text = File.ReadAllText(filePath);
Console.WriteLine(text);
So, the only thing here that's really iPhone-specific is knowing that 
"Environment.SpecialFolder.Personal" maps to your app's Documents folder. 
Beyond that, it's .Net as usual.

And, again, this was probably overkill, but I wanted to answer sufficiently 
thoroughly for everybody who sees it - hope this helps :)






Keep in mind though that only application generated content should be stored in the 
Personal folder. Regenerable, reusable across sessions content should be stored in 
the Cache folder, and temporary (discardable between sessions) stuff in the 
temporary folder. I had may app rejected once for storing in the Personal 
folder content considered by the Apple reviewer as not generated by the app




u can do something like this at runtime:

using (StreamWriter writer = new StreamWriter 
(Path.Combine (Environment.SpecialFolders.Documents, "yourfilename.ext"))) { }

and that will create the file. To open it for reading, use the same Path.Combine(), 
but with StreamReader.

-->










